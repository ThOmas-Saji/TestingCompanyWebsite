echo "🔍 Checking Node.js version compatibility..."
node .husky/node-version-check.cjs

echo "🔒 Running security checks..."
node .husky/security-check.cjs

echo "🌿 Validating branch configuration..."
node .husky/branch-check.cjs

echo "📝 Checking branch naming conventions..."
node .husky/branch-name-check.cjs

echo "✨ Checking code formatting with Prettier..."
if ! npm run format:check; then
  redBold='\x1b[1;31m'
  yellowBold='\x1b[1;33m'
  cyanBold='\x1b[1;36m'
  reset='\x1b[0m'
  bgRed='\x1b[41m'
  whiteBold='\x1b[1;37m'

  echo ""
  echo -e "${bgRed}${whiteBold}                                                      ${reset}"
  echo -e "${bgRed}${whiteBold}      🎨 COMMIT BLOCKED - FORMATTING ISSUES! 🎨    ${reset}"
  echo -e "${bgRed}${whiteBold}                                                      ${reset}"
  echo ""
  echo -e "${redBold}┌──────────────────────────────────────────────────────┐${reset}"
  echo -e "${redBold}│  ❌ Code formatting issues detected!                │${reset}"
  echo -e "${redBold}│  📝 Please fix formatting and try again             │${reset}"
  echo -e "${redBold}└──────────────────────────────────────────────────────┘${reset}"
  echo ""
  echo -e "${yellowBold}🔧 Quick fix: npm run format && npm run lint && git add . && git commit${reset}"
  echo ""
  exit 1
fi

echo "🧹 Linting code for quality and consistency..."
if ! npm run lint; then
  redBold='\x1b[1;31m'
  yellowBold='\x1b[1;33m'
  reset='\x1b[0m'
  bgRed='\x1b[41m'
  whiteBold='\x1b[1;37m'

  echo ""
  echo -e "${bgRed}${whiteBold}                                                      ${reset}"
  echo -e "${bgRed}${whiteBold}      🐛 COMMIT BLOCKED - LINTING ERRORS! 🐛       ${reset}"
  echo -e "${bgRed}${whiteBold}                                                      ${reset}"
  echo ""
  echo -e "${redBold}┌──────────────────────────────────────────────────────┐${reset}"
  echo -e "${redBold}│  ❌ Linting failed! Please fix the issues above     │${reset}"
  echo -e "${redBold}│  💡 Common fixes:                                   │${reset}"
  echo -e "${redBold}│    - Remove unused variables and imports            │${reset}"
  echo -e "${redBold}│    - Fix syntax errors                              │${reset}"
  echo -e "${redBold}│    - Follow coding standards                        │${reset}"
  echo -e "${redBold}└──────────────────────────────────────────────────────┘${reset}"
  echo ""
  exit 1
fi

echo "🏗️ Running build verification..."
node .husky/build-check.cjs

echo "✅ All pre-commit checks passed! Your code is ready to commit."
